# システム・技術要件詳細化書

## 文書管理情報
- **文書バージョン**: 1.8.0
- **作成日**: 2025-11-23
- **最終更新日**: 2026-01-19

---


## 2. フロントエンド技術仕様

### 2.1 技術スタック詳細

#### 2.1.1 コアライブラリ

| ライブラリ | バージョン | 用途 | 選定理由 |
|-----------|----------|------|---------|
| React | 19.x | UIフレームワーク | 最新の並行レンダリング、Server Components対応 |
| TypeScript | 5.x | 型システム | 型安全性、開発効率向上 |
| Vite | 6.x | ビルドツール | 高速なHMR、最適化されたプロダクションビルド |
| React Router | 7.x | ルーティング | 宣言的ルーティング、Code Splitting対応 |

#### 2.1.2 状態管理

| ライブラリ | バージョン | 用途 | 選定理由 |
|-----------|----------|------|---------|
| Zustand | 5.x | グローバル状態管理 | シンプルなAPI、Redux不要、型安全 |
| React Query (TanStack Query) | 5.x | サーバーステート管理 | キャッシュ管理、自動リフェッチ、楽観的更新 |
| React Hook Form | 7.x | フォーム管理 | パフォーマンス最適化、バリデーション統合 |


#### 2.1.3 UIライブラリ

| ライブラリ | バージョン | 用途 | 選定理由 |
|-----------|----------|------|---------|
| Tailwind CSS | 3.4.x | スタイリング | ユーティリティファースト、カスタマイズ性 |
| shadcn/ui | latest | UIコンポーネント | アクセシブル、カスタマイズ可能、Tailwind統合 |
| Radix UI | 1.x | Headless UI | アクセシビリティ完全対応、WAI-ARIA準拠 |
| Lucide React | latest | アイコン | 軽量、Tree-shaking対応 |


#### 2.1.4 バリデーション

| ライブラリ | バージョン | 用途 | 選定理由 |
|-----------|----------|------|---------|
| Zod | 3.x | スキーマバリデーション | TypeScript型推論、React Hook Form統合 |


#### 2.1.5 ユーティリティ

| ライブラリ | バージョン | 用途 |
|-----------|----------|------|
| date-fns | 3.x | 日付操作 |
| axios | 1.x | HTTP クライアント |
| clsx | 2.x | 条件付きクラス名生成 |
| DOMPurify | 3.x | XSS対策（HTMLサニタイズ） |

### 2.2 ディレクトリ構造（Bulletproof-react パターン）

```
frontend/
├── public/                    # 静的ファイル
│   ├── favicon.ico
│   └── robots.txt
├── src/
│   ├── app/                   # アプリケーションエントリーポイント
│   │   ├── App.tsx            # ルートコンポーネント
│   │   ├── main.tsx           # エントリーファイル
│   │   └── router.tsx         # ルーティング定義
│   │
│   ├── features/              # 機能別モジュール（Feature-Sliced Design）
│   │   ├── sample/              # サンプ機能
│   │   │   ├── api/           # API呼び出し
│   │   │   ├── components/    # 機能固有のコンポーネント
│   │   │   ├── hooks/         # カスタムフック
│   │   │   ├── pages/         # ページコンポーネント
│   │   │   ├── schemas/       # バリデーションスキーマ
│   │   │   ├── stores/        # Zustand ストア
│   │   │   ├── types/         # 型定義
│   │   │   └── index.ts       # パブリックAPI
│   │
│   ├── components/            # 共通コンポーネント
│   │   ├── ui/                # shadcn/ui コンポーネント
│   │   │   ├── button.tsx
│   │   │   ├── input.tsx
│   │   │   ├── card.tsx
│   │   │   └── ...
│   │   ├── layouts/           # レイアウトコンポーネント
│   │   └── ErrorBoundary.tsx  # エラーバウンダリ
│   │
│   ├── lib/                   # ライブラリ設定・ユーティリティ
│   │   ├── api-client.ts      # Axios設定
│   │   ├── react-query.ts     # React Query設定
│   │   ├── utils.ts           # 汎用ユーティリティ
│   │   └── cn.ts              # clsx + tailwind-merge
│   │
│   ├── hooks/                 # グローバルカスタムフック
│   │
│   ├── types/                 # グローバル型定義
│   │
│   ├── constants/             # 定数定義
│   │   ├── routes.ts
│   │   └── config.ts
│   │
│   └── styles/                # グローバルスタイル
│       └── index.css
│
├── .eslintrc.cjs              # ESLint設定
├── .prettierrc                # Prettier設定
├── tsconfig.json              # TypeScript設定
├── vite.config.ts             # Vite設定
├── tailwind.config.js         # Tailwind設定
└── package.json
```

### 2.3 コーディング規約

#### 2.3.1 命名規則

| 対象 | 規則 | 例 |
|------|------|-----|
| コンポーネント | PascalCase | `LoginForm.tsx`, `ProjectCard.tsx` |
| フック | camelCase + use接頭辞 | `useAuth.ts`, `useProjects.ts` |
| 定数 | UPPER_SNAKE_CASE | `API_BASE_URL`, `MAX_FILE_SIZE` |
| 型・インターフェース | PascalCase | `User`, `ProjectDetail` |
| 関数 | camelCase | `fetchProjects`, `handleSubmit` |
| ファイル名 | kebab-case または PascalCase | `api-client.ts`, `ProjectList.tsx` |

#### 2.3.2 TypeScript 型定義

**優先順位**:
1. `interface` を優先（拡張性のため）
2. Union型やUtility型が必要な場合は `type`

```typescript
// ✅ 推奨: interface
interface User {
  id: string;
  email: string;
  name: string;
  role: UserRole;
}

// ✅ 推奨: type（Union型）
type UserRole = 'operator' | 'admin' | 'member';

// ✅ 推奨: type（APIレスポンス）
type ApiResponse<T> = {
  data: T;
  meta?: {
    total: number;
    page: number;
  };
};
```

#### 2.3.3 React コンポーネント

**関数コンポーネント + TypeScript**:
```typescript
// ✅ 推奨
interface ProjectCardProps {
  project: Project;
  onEdit?: (id: string) => void;
  className?: string;
}

export function ProjectCard({ project, onEdit, className }: ProjectCardProps) {
  return (
    <div className={cn('rounded-lg border p-4', className)}>
      <h3>{project.name}</h3>
      {onEdit && <button onClick={() => onEdit(project.id)}>編集</button>}
    </div>
  );
}
```

**カスタムフック**:
```typescript
// src/features/projects/hooks/useProjects.ts
import { useQuery } from '@tanstack/react-query';
import { getProjects } from '../api/getProjects';

export function useProjects() {
  return useQuery({
    queryKey: ['projects'],
    queryFn: getProjects,
    select: (data) => data.data, // レスポンスから必要なデータのみ抽出
  });
}
```


### 2.4 パフォーマンス最適化

#### 2.4.1 Code Splitting（コード分割）

```typescript
// src/app/router.tsx
import { lazy, Suspense } from 'react';
import { createBrowserRouter } from 'react-router-dom';

const Dashboard = lazy(() => import('@/features/dashboard/pages/Dashboard'));
const ProjectList = lazy(() => import('@/features/projects/pages/ProjectList'));
const ProjectDetail = lazy(() => import('@/features/projects/pages/ProjectDetail'));

export const router = createBrowserRouter([
  {
    path: '/',
    element: <AppLayout />,
    children: [
      {
        index: true,
        element: (
          <Suspense fallback={<LoadingSpinner />}>
            <Dashboard />
          </Suspense>
        ),
      },
      {
        path: 'projects',
        element: (
          <Suspense fallback={<LoadingSpinner />}>
            <ProjectList />
          </Suspense>
        ),
      },
    ],
  },
]);
```

#### 2.4.2 React.memo / useMemo / useCallback

```typescript
import { memo, useMemo, useCallback } from 'react';

// 重い計算をメモ化
function ProjectList({ projects }: { projects: Project[] }) {
  const sortedProjects = useMemo(() => {
    return [...projects].sort((a, b) => b.created_at.localeCompare(a.created_at));
  }, [projects]);

  const handleClick = useCallback((id: string) => {
    console.log('Clicked:', id);
  }, []);

  return (
    <div>
      {sortedProjects.map((project) => (
        <ProjectCard key={project.id} project={project} onClick={handleClick} />
      ))}
    </div>
  );
}

// 再レンダリング抑制
const ProjectCard = memo(function ProjectCard({ project, onClick }: ProjectCardProps) {
  return <div onClick={() => onClick(project.id)}>{project.name}</div>;
});
```
